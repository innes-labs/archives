RewriteEngine On
RewriteCond %{HTTP_HOST}@@%{HTTP_REFERER} !^([^@]*)@@https?://\1(:[0-9]{2,4})?/.*
RewriteRule .* - [NC,F]